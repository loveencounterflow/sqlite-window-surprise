
------------------------------------------------------------------------------------------------------------
Current table contents

```
┌───┬───┬────┐
│ n │ i │ v  │
├───┼───┼────┤
│ a │ 1 │ 11 │
│ a │ 2 │ 21 │
│ a │ 3 │ 31 │
│ b │ 1 │ 12 │
│ b │ 2 │ 22 │
│ c │ 1 │ 13 │
│ c │ 2 │ 23 │
│ c │ 3 │ 33 │
│ c │ 4 │ 43 │
└───┴───┴────┘
```

------------------------------------------------------------------------------------------------------------
Several ways to aggregate values with `*group*()` functions, all of them working as expected:

```
┌───┬───────────────────────────────┐
│ n │   json_group_array() nested   │
├───┼───────────────────────────────┤
│ a │ [[1,11],[2,21],[3,31]]        │
│ b │ [[1,12],[2,22]]               │
│ c │ [[1,13],[2,23],[3,33],[4,43]] │
└───┴───────────────────────────────┘
┌───┬───────────────────────────────┐
│ n │      json_group_object()      │
├───┼───────────────────────────────┤
│ a │ {"1":11,"2":21,"3":31}        │
│ b │ {"1":12,"2":22}               │
│ c │ {"1":13,"2":23,"3":33,"4":43} │
└───┴───────────────────────────────┘
┌───┬─────────────────────────┐
│ n │ json_group_array() flat │
├───┼─────────────────────────┤
│ a │ [11,21,31]              │
│ b │ [12,22]                 │
│ c │ [13,23,33,43]           │
└───┴─────────────────────────┘
┌───┬────────────────────────────────┐
│ n │         group_concat()         │
├───┼────────────────────────────────┤
│ a │ (1,11), (2,21), (3,31)         │
│ b │ (1,12), (2,22)                 │
│ c │ (1,13), (2,23), (3,33), (4,43) │
└───┴────────────────────────────────┘
```

------------------------------------------------------------------------------------------------------------
Using several aggregate functions in the same table using the same window definition all fail, with the
exception of the *last* aggregate and `group_concat()`, which do work as expected:

```
┌───┬───────────────────────────────┬───────────────────────────────┬─────────────────────────┬────────────────────────────────┐
│ n │   json_group_array() nested   │      json_group_object()      │ json_group_array() flat │         group_concat()         │
├───┼───────────────────────────────┼───────────────────────────────┼─────────────────────────┼────────────────────────────────┤
│ a │ [[1,11],[1,11],[1,11]]        │ {"1":11,"1":11,"1":11}        │ [11,11,11]              │ (1,11), (2,21), (3,31)         │
│ b │ [[1,12],[1,12]]               │ {"1":12,"1":12}               │ [12,12]                 │ (1,12), (2,22)                 │
│ c │ [[1,13],[1,13],[1,13],[1,13]] │ {"1":13,"1":13,"1":13,"1":13} │ [13,13,13,13]           │ (1,13), (2,23), (3,33), (4,43) │
└───┴───────────────────────────────┴───────────────────────────────┴─────────────────────────┴────────────────────────────────┘
┌───┬───────────────────────────────┬───────────────────────────────┬────────────────────────────────┬─────────────────────────┐
│ n │   json_group_array() nested   │      json_group_object()      │         group_concat()         │ json_group_array() flat │
├───┼───────────────────────────────┼───────────────────────────────┼────────────────────────────────┼─────────────────────────┤
│ a │ [[1,11],[1,11],[1,11]]        │ {"1":11,"1":11,"1":11}        │ (1,11), (2,21), (3,31)         │ [11,21,31]              │
│ b │ [[1,12],[1,12]]               │ {"1":12,"1":12}               │ (1,12), (2,22)                 │ [12,22]                 │
│ c │ [[1,13],[1,13],[1,13],[1,13]] │ {"1":13,"1":13,"1":13,"1":13} │ (1,13), (2,23), (3,33), (4,43) │ [13,23,33,43]           │
└───┴───────────────────────────────┴───────────────────────────────┴────────────────────────────────┴─────────────────────────┘
┌───┬───────────────────────────────┬────────────────────────────────┬───────────────────────────────┬─────────────────────────┐
│ n │   json_group_array() nested   │         group_concat()         │      json_group_object()      │ json_group_array() flat │
├───┼───────────────────────────────┼────────────────────────────────┼───────────────────────────────┼─────────────────────────┤
│ a │ [[1,11],[1,11],[1,11]]        │ (1,11), (2,21), (3,31)         │ {"1":11,"1":11,"1":11}        │ [11,21,31]              │
│ b │ [[1,12],[1,12]]               │ (1,12), (2,22)                 │ {"1":12,"1":12}               │ [12,22]                 │
│ c │ [[1,13],[1,13],[1,13],[1,13]] │ (1,13), (2,23), (3,33), (4,43) │ {"1":13,"1":13,"1":13,"1":13} │ [13,23,33,43]           │
└───┴───────────────────────────────┴────────────────────────────────┴───────────────────────────────┴─────────────────────────┘
┌───┬───────────────────────────────┬────────────────────────────────┬─────────────────────────┬───────────────────────────────┐
│ n │   json_group_array() nested   │         group_concat()         │ json_group_array() flat │      json_group_object()      │
├───┼───────────────────────────────┼────────────────────────────────┼─────────────────────────┼───────────────────────────────┤
│ a │ [[1,11],[1,11],[1,11]]        │ (1,11), (2,21), (3,31)         │ [11,11,11]              │ {"1":11,"2":21,"3":31}        │
│ b │ [[1,12],[1,12]]               │ (1,12), (2,22)                 │ [12,12]                 │ {"1":12,"2":22}               │
│ c │ [[1,13],[1,13],[1,13],[1,13]] │ (1,13), (2,23), (3,33), (4,43) │ [13,13,13,13]           │ {"1":13,"2":23,"3":33,"4":43} │
└───┴───────────────────────────────┴────────────────────────────────┴─────────────────────────┴───────────────────────────────┘
```

------------------------------------------------------------------------------------------------------------
`group_concat()` works even with unquoted values, even in the midst of other aggregators:

```
┌───┬───────────────────────────────┬────────────────────────────────┬───────────────────┬───────────────────┬─────────────────────────┬───────────────────────────────┐
│ n │   json_group_array() nested   │         group_concat()         │ group_concat( i ) │ group_concat( v ) │ json_group_array() flat │      json_group_object()      │
├───┼───────────────────────────────┼────────────────────────────────┼───────────────────┼───────────────────┼─────────────────────────┼───────────────────────────────┤
│ a │ [[1,11],[1,11],[1,11]]        │ (1,11), (2,21), (3,31)         │ 1,2,3             │ 11,21,31          │ [11,11,11]              │ {"1":11,"2":21,"3":31}        │
│ b │ [[1,12],[1,12]]               │ (1,12), (2,22)                 │ 1,2               │ 12,22             │ [12,12]                 │ {"1":12,"2":22}               │
│ c │ [[1,13],[1,13],[1,13],[1,13]] │ (1,13), (2,23), (3,33), (4,43) │ 1,2,3,4           │ 13,23,33,43       │ [13,13,13,13]           │ {"1":13,"2":23,"3":33,"4":43} │
└───┴───────────────────────────────┴────────────────────────────────┴───────────────────┴───────────────────┴─────────────────────────┴───────────────────────────────┘
```

------------------------------------------------------------------------------------------------------------
Using `json_group_array()` fails where not last in a series of aggregations:

```
┌───┬─────────────────────────┬─────────────────────────┬─────────────────────────┐
│ n │ json_group_array( i ) 1 │ json_group_array( i ) 2 │ json_group_array( i ) 3 │
├───┼─────────────────────────┼─────────────────────────┼─────────────────────────┤
│ a │ [1,1,1]                 │ [1,1,1]                 │ [1,2,3]                 │
│ b │ [1,1]                   │ [1,1]                   │ [1,2]                   │
│ c │ [1,1,1,1]               │ [1,1,1,1]               │ [1,2,3,4]               │
└───┴─────────────────────────┴─────────────────────────┴─────────────────────────┘
```

------------------------------------------------------------------------------------------------------------
Turning values into strings does not affect outcomes:

```
┌───┬───────────────────────────┬───────────────────────────┬───────────────────────────┐
│ n │  json_group_array( i ) 1  │  json_group_array( i ) 2  │  json_group_array( i ) 3  │
├───┼───────────────────────────┼───────────────────────────┼───────────────────────────┤
│ a │ ["(1)","(1)","(1)"]       │ ["(1)","(1)","(1)"]       │ ["(1)","(2)","(3)"]       │
│ b │ ["(1)","(1)"]             │ ["(1)","(1)"]             │ ["(1)","(2)"]             │
│ c │ ["(1)","(1)","(1)","(1)"] │ ["(1)","(1)","(1)","(1)"] │ ["(1)","(2)","(3)","(4)"] │
└───┴───────────────────────────┴───────────────────────────┴───────────────────────────┘
```

------------------------------------------------------------------------------------------------------------
Using a separate but identical window definition for each aggregate does not affect outcomes:

```
┌───┬───────────────────────────────┬────────────────────────────────┬─────────────────────────┬───────────────────────────────┐
│ n │   json_group_array() nested   │         group_concat()         │ json_group_array() flat │      json_group_object()      │
├───┼───────────────────────────────┼────────────────────────────────┼─────────────────────────┼───────────────────────────────┤
│ a │ [[1,11],[1,11],[1,11]]        │ (1,11), (2,21), (3,31)         │ [11,11,11]              │ {"1":11,"2":21,"3":31}        │
│ b │ [[1,12],[1,12]]               │ (1,12), (2,22)                 │ [12,12]                 │ {"1":12,"2":22}               │
│ c │ [[1,13],[1,13],[1,13],[1,13]] │ (1,13), (2,23), (3,33), (4,43) │ [13,13,13,13]           │ {"1":13,"2":23,"3":33,"4":43} │
└───┴───────────────────────────────┴────────────────────────────────┴─────────────────────────┴───────────────────────────────┘
```

------------------------------------------------------------------------------------------------------------
Aggregate function `sum()` is not affected; results show unambiguously that summing is indeed done over the
values shown in the `group_concat()` lists, even in the midst of other aggregators:

```
┌───┬───────────────────┬───────────────────┬──────────┬──────────┬───────────────────────┐
│ n │ group_concat( i ) │ group_concat( v ) │ sum( i ) │ sum( v ) │ json_group_array( i ) │
├───┼───────────────────┼───────────────────┼──────────┼──────────┼───────────────────────┤
│ a │ 1,2,3             │ 11,21,31          │ 6        │ 63       │ [1,2,3]               │
│ b │ 1,2               │ 12,22             │ 3        │ 34       │ [1,2]                 │
│ c │ 1,2,3,4           │ 13,23,33,43       │ 10       │ 112      │ [1,2,3,4]             │
└───┴───────────────────┴───────────────────┴──────────┴──────────┴───────────────────────┘
```

------------------------------------------------------------------------------------------------------------
`json_group_array()` also fails when not coming last when combined with `sum()`; observe the discrepancies
between numbers listed and numbers summed:

```
┌───┬───────────────────────┬──────────┬───────────────────────┬──────────┐
│ n │ json_group_array( i ) │ sum( i ) │ json_group_array( v ) │ sum( v ) │
├───┼───────────────────────┼──────────┼───────────────────────┼──────────┤
│ a │ [1,1,1]               │ 6        │ [11,11,11]            │ 63       │
│ b │ [1,1]                 │ 3        │ [12,12]               │ 34       │
│ c │ [1,1,1,1]             │ 10       │ [13,13,13,13]         │ 112      │
└───┴───────────────────────┴──────────┴───────────────────────┴──────────┘
```
